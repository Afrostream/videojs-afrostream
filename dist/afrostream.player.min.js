/*! videojs-afrostream - v0.17.5 - 2015-10-09
* Copyright (c) 2015 Brightcove; Licensed  */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("vjs requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){return videojs.Bitdash=videojs.Html5.extend({init:function(a,b,c){videojs.Html5.call(this,a,b,c);document.getElementById("video").getElementsByTagName("video")[0];a.trigger("loadedmetadata")}}),videojs.Bitdash.prototype.bitdashPlayer={},videojs.Bitdash.extend=function(a,b,c){for(c in b)b.hasOwnProperty(c)&&("[object Object]"===Object.prototype.toString.call(b[c])?a[c]=videojs.Bitdash.extend(a[c]||{},b[c]):a[c]=b[c]);return a},videojs.Bitdash.prototype.setSrc=function(a){this.bitdashPlayer.load(a)},videojs.Bitdash.prototype.load=function(){this.bitdashPlayer.load(this.player().currentSrc())},videojs.Bitdash.prototype.dispose=function(){this.bitdashPlayer.destroy(),videojs.Html5.prototype.dispose.call(this)},videojs.Bitdash.extractMime=function(a){var b=/(\/[^?]+).*/,c=a.match(b),d=c[1].split("."),e=d.length>1?d.pop():"mp4";return e},videojs.Bitdash.extractType=function(a){var b=videojs.Bitdash.extractMime(a.src),c={};switch(b){case"m3u8":c.type="application/vnd.apple.mpegurl",c.format="hls";break;case"mpd":c.type="application/dash+xml",c.format="dash"}return c},videojs.Bitdash.prototype.onClick=function(a){},videojs.Bitdash.prototype.createEl=function(){var a=this.player_,b=a.tag,c={};videojs.Html5.disposeMediaElement(b),b=videojs.createEl("div",{id:a.id()+"_bitdash_api",className:"vjs-tech"}),b.player=a,videojs.insertFirst(b,a.el()),videojs.obj.each(a.options_.sources,function(a,b){var d=videojs.Bitdash.extractType(b);c[d.format]=b.src});var d={key:this.options().key,source:c,playback:{autoplay:a.options().autoplay,muted:a.options().muted,audioLanguage:["fr","en"],subtitleLanguage:"fr"},style:{width:"100%",height:"100%",controls:!1}};return this.bitdashPlayer=new bitdash(b.id).setup(d),this.bitdashPlayer.addEventHandler("onReady",videojs.bind(this,function(a){this.triggerReady()})),this.bitdashPlayer.addEventHandler("onPlay",videojs.bind(this,this.onPlay)),this.bitdashPlayer.addEventHandler("onError",videojs.bind(this,this.onError)),this.bitdashPlayer.addEventHandler("onVolumeChange",videojs.bind(this,this.onVolumeChange)),this.bitdashPlayer.addEventHandler("onMute",videojs.bind(this,this.onVolumeChange)),this.bitdashPlayer.addEventHandler("onUnmute",videojs.bind(this,this.onVolumeChange)),this.bitdashPlayer.addEventHandler("onSeek",videojs.bind(this,this.onSeek)),this.bitdashPlayer.addEventHandler("onStopBuffering",videojs.bind(this,this.onStopBuffering)),this.bitdashPlayer.addEventHandler("onFullscreenEnter",videojs.bind(this,this.onFullscreenChange)),this.bitdashPlayer.addEventHandler("onFullscreenExit",videojs.bind(this,this.onFullscreenChange)),this.bitdashPlayer.addEventHandler("onPlaybackFinished",videojs.bind(this,this.onEnded)),this.bitdashPlayer.addEventHandler("onTimeChanged",videojs.bind(this,this.onTimeChanged)),this.bitdashPlayer.addEventHandler("onVideoPlaybackQualityChange",videojs.bind(this,this.onQualityChange)),b},videojs.Bitdash.prototype.onQualityChange=function(a){this.trigger("bitratechange")},videojs.Bitdash.prototype.onTimeChanged=function(a){this.trigger("durationchange")},videojs.Bitdash.prototype.onFullscreenChange=function(a){this.trigger("fullscreenchange")},videojs.Bitdash.prototype.onPlay=function(a){this.trigger("play")},videojs.Bitdash.prototype.onError=function(a){this.trigger("error")},videojs.Bitdash.prototype.onEnded=function(a){this.trigger("ended")},videojs.Bitdash.prototype.onVolumeChange=function(a){this.trigger("volumechange")},videojs.Bitdash.prototype.onStopBuffering=function(a){this.trigger("seeked")},videojs.Bitdash.prototype.onSeek=function(a){this.trigger("seeking")},videojs.Bitdash.prototype.play=function(){this.bitdashPlayer.play()},videojs.Bitdash.prototype.pause=function(){this.bitdashPlayer.pause()},videojs.Bitdash.prototype.paused=function(){return this.bitdashPlayer.isPaused()},videojs.Bitdash.prototype.currentTime=function(){return this.bitdashPlayer.getCurrentTime()},videojs.Bitdash.prototype.duration=function(){return this.bitdashPlayer.getDuration()},videojs.Bitdash.prototype.setCurrentTime=function(a){this.bitdashPlayer.seek(a)},videojs.Bitdash.prototype.buffered=function(){return this.bitdashPlayer.isStalled()},videojs.Bitdash.prototype.volume=function(){return this.bitdashPlayer.getVolume()/100},videojs.Bitdash.prototype.setVolume=function(a){this.bitdashPlayer.setVolume(100*a)},videojs.Bitdash.prototype.muted=function(){return this.bitdashPlayer.isMuted()},videojs.Bitdash.prototype.setMuted=function(a){a?this.bitdashPlayer.mute():this.bitdashPlayer.unmute()},videojs.Bitdash.prototype.enterFullScreen=function(){this.bitdashPlayer.enterFullScreen()},videojs.Bitdash.prototype.exitFullScreen=function(){this.bitdashPlayer.exitFullScreen()},videojs.Bitdash.supportsNativeHls=function(){var a,b,c=document.createElement("video");return videojs.Html5.isSupported()?(a=c.canPlayType("application/x-mpegURL"),b=c.canPlayType("application/vnd.apple.mpegURL"),/probably|maybe/.test(a)||/probably|maybe/.test(b)):!1}(),videojs.Bitdash.isSupported=function(){return!videojs.Bitdash.supportsNativeHls&&a.Uint8Array},videojs.Bitdash.canPlaySource=function(a){var b=/^application\/dash\+xml/i;return b.test(a.type)},videojs.options.techOrder.unshift("bitdash"),videojs.MediaTechController.withSourceHandlers(videojs.Bitdash),videojs.Bitdash.nativeSourceHandler={},videojs.Bitdash.nativeSourceHandler.canHandleSource=function(a){return!0},videojs.Bitdash.nativeSourceHandler.handleSource=function(a,b){b.setSrc(a)},videojs.Bitdash.nativeSourceHandler.dispose=function(){},videojs.Bitdash.registerSourceHandler(videojs.Bitdash.nativeSourceHandler),function(){var b=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return null==c&&(c={}),d={},this.options()["data-setup"]&&(m=JSON.parse(this.options()["data-setup"]),m.ga&&(d=m.ga)),e=["loaded","percentsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen"],j=c.eventsToTrack||d.eventsToTrack||e,p=c.percentsPlayedInterval||d.percentsPlayedInterval||10,h=c.eventCategory||d.eventCategory||"Video",i=c.eventLabel||d.eventLabel,c.debug=c.debug||!1,o=[],t=s=0,u=!1,l=function(){i||(i=this.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),b.call(j,"loadedmetadata")>=0&&v("loadedmetadata",!0)},w=function(){var a,c,d,e,f;for(a=Math.round(this.currentTime()),c=Math.round(this.duration()),e=Math.round(a/c*100),d=f=0;99>=f;d=f+=p)e>=d&&b.call(o,d)<0&&(b.call(j,"start")>=0&&0===d&&e>0?v("start",!0):b.call(j,"percentsPlayed")>=0&&0!==e&&v("percent played",!0,d),e>0&&o.push(d));b.call(j,"seek")>=0&&(t=s,s=a,Math.abs(t-s)>1&&(u=!0,v("seek start",!1,t),v("seek end",!1,s)))},f=function(){v("end",!0)},q=function(){var a;a=Math.round(this.currentTime()),v("play",!0,a),u=!1},n=function(){var a,b;a=Math.round(this.currentTime()),b=Math.round(this.duration()),a===b||u||v("pause",!1,a)},x=function(){var a;a=this.muted()===!0?0:this.volume(),v("volume change",!1,a)},r=function(){v("resize - "+this.width()+"*"+this.height(),!0)},g=function(){var a;a=Math.round(this.currentTime()),v("error",!0,a)},k=function(){var a;a=Math.round(this.currentTime()),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?v("enter fullscreen",!1,a):v("exit fullscreen",!1,a)},v=function(b,d,e){a.ga?ga("send","event",{eventCategory:h,eventAction:b,eventLabel:i,eventValue:e,nonInteraction:d}):a._gaq?_gaq.push(["_trackEvent",h,b,i,e,d]):c.debug&&console.log("Google Analytics not detected")},this.ready(function(){return this.on("loadedmetadata",l),this.on("timeupdate",w),b.call(j,"end")>=0&&this.on("ended",f),b.call(j,"play")>=0&&this.on("play",q),b.call(j,"pause")>=0&&this.on("pause",n),b.call(j,"volumeChange")>=0&&this.on("volumechange",x),b.call(j,"resize")>=0&&this.on("resize",r),b.call(j,"error")>=0&&this.on("error",g),b.call(j,"fullscreen")>=0?this.on("fullscreenchange",k):void 0}),{sendbeacon:v}})}.call(this),function(a,b){"use strict";var c,d,e={option:!0,user_id:"",method:"POST",responseType:"json",timeout:1e3,url:"//stats.afrostream.tv/api/v1/events",trackEvents:["firstplay","ended","waiting","error","bitratechange","dispose"]};d=function(){var a,b,c,d,e={},f=null,g=null,h=null;return a=function(){var a=navigator.userAgent.toLowerCase(),b=/(ie|firefox|chrome|safari|opera)(?:.*version)?(?:[ \/])?([\w.]+)/.exec(a),c=/(mac|win|linux|freebsd|mobile|iphone|ipod|ipad|android|blackberry|j2me|webtv)/.exec(a);a.match(/trident\/7\./)?(f="ie",g=11):b&&b.length>2&&(f=b[1],g=b[2]),c&&c.length>1&&(h=c[1])},b=function(){e.browser=f,e.version=parseInt(g,10)||null,e.os=h},c=function(){"mac"===h&&(h="osx")},d=function(){"safari"===h&&(g=g.substring(0,1))},a(),c(),d(),b(),e};var f=["user_id","type","fqdn"],g={bandwidthIncrease:["video_bitrate","audio_bitrate"],bandwidthDecrease:["video_bitrate","audio_bitrate"],buffering:[],error:["number","message"],start:["os","os_version","web_browser","web_browser_version","resolution_size","flash_version","html5_video","relative_url"],stop:["timeout","frames_dropped"]};c=function(c){var h,i,j,k,l,m,n=b.util.mergeOptions(e,c),o=this,p=d(),q=/https?:\/\/(?:www\.)?([-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b)*(\/[\/\d\w\.-]*)*(?:[\?])*(.+)*/gi,r=q.exec(o.currentSrc());n.user_id=n.user_id||666,i=function(a){var b={type:a.type};switch(b.type){case"ended":b.type="stop";break;case"firstplay":b.type="start";break;case"waiting":b.type="buffering"}j(b)},h=function(){for(var a=n.trackEvents.length-1;a>=0;a--)o.on(n.trackEvents[a],b.bind(this,i))},l=function(a,b,c){var d={};return"string"==typeof b&&(b=[b]),Object.keys(a).forEach(function(c){b.indexOf(c)>-1&&(d[c]=a[c])},c),d},m=function(a){return f.concat(g[a]||[])},j=function(a){a.user_id=n.user_id,a.fqdn=r[1],a.os=p.os,a.os_version=p.version.toString(),a.web_browser=p.browser,a.web_browser_version=p.web_browser_version,a.resolution_size=screen.width+"x"+screen.height,a.flash_version=b.Flash.version().join(","),a.html5_video="html5"===o.techName,a.relative_url=r[2],a.timeout=!1,a.frames_dropped=0;var c=l(a,m(a.type));k(n,c)},k=function(c,d,e){var f,g,h={method:"GET",timeout:45e3};"function"!=typeof e&&(e=function(){}),"object"==typeof c&&(h=b.util.mergeOptions(h,c),c=h.url);var i=a.XMLHttpRequest;"undefined"==typeof i&&(i=function(){try{return new a.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(b){}try{return new a.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(c){}try{return new a.ActiveXObject("Msxml2.XMLHTTP")}catch(d){}throw new Error("This browser does not support XMLHttpRequest.")}),f=new i,f.open(h.method,c),f.url=c,f.requestTime=(new Date).getTime(),f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.responseType&&(f.responseType=h.responseType),h.withCredentials&&(f.withCredentials=!0),h.timeout&&(g=a.setTimeout(function(){4!==f.readyState&&(f.timedout=!0,f.abort())},h.timeout)),f.onreadystatechange=function(){return 4===this.readyState?(a.clearTimeout(g),f.timedout?e.call(this,"timeout",c):this.status>=400||0===this.status?e.call(this,!0,c):(this.response&&(this.responseTime=(new Date).getTime(),this.roundTripTime=this.responseTime-this.requestTime,this.bytesReceived=this.response.byteLength||this.response.length,this.bandwidth=Math.floor(this.bytesReceived/this.roundTripTime*8*1e3)),e.call(this,!1,c))):void 0};var j="";if("object"==typeof d)for(var k in d)j+=(0===j.length?"":"&")+k+"="+encodeURIComponent(d[k]);return f.send(j),f},h()},b.plugin("metrics",c)}(a,a.videojs),videojs});